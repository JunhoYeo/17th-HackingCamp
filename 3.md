# LTE? is it secure?
신정훈 발표자님<br>
http://www.ndsl.kr/ndsl/commons/util/ndslOriginalView.do?dbt=JAKO&cn=JAKO201627248175340&oCn=JAKO201627248175340&pageCode=PG11&journal=NJOU00550315<br>
발표 끝나고 궁금해져서 논문도 찾아봄

## 오늘 할 이야기들

- LTE 네트워크에 대해 간단히~

- 한국의 펨토셀(LTE 장치를 구현할 수 있는 장치) 벤더와 장비들

- 구조

- 뭘 할 수 있는지

## 간단한 LTE Network
Femtocell

- UE : 핸드폰

- FAP(기지국)

- 게이트웨이(SeGW, FemtoGW)

## 펨토셀이란?

- 아주 작은 기지국

- 음영지역 해소 목적

- Gap Filter(커버하는 범위) : 10~12m 범위

- LTE 네트워크의 중요 부분

- 펨토셀을 사용하면 쉽게 모바일 장비 패킷을 스니핑, 연결된 모바일 장치를 제어할 수 있음

## 몇 년 후에는?
공유기 대신 각 집에 펨토셀을 넣어줘서 기지국 역할을 할 수 있도록 하려는 목적

## 펨토셀 벤더와 장비들
삼성, 시스코, 인텔, 노키아, 화웨이...

## 펨토셀 제공 통신사

- SK : InnoWireless, Contela

- KT : InnoWireless, (또 뭐 하나 못본 거)

- LG U+ : CNSLink

## 문제
한국에서는 펨토셀 장비를 개인에게 절대 팔지 않음

## 어떻게 펨토셀 장비를 해킹했나요?
1. 웹에서 펨토셀에 대한 정보를 모음(구글링)<br>
펨토셀이 설치된 장소를 알 수 있었음<br>
스타벅스 강남2호점에 설치된 펨토셀의 IP주소와 디바이스 정보(벤더이름 등)을 찍어옴
2. 포트 스캔으로 IP 주소로부터 유용한 정보들을 얻어냄<br>
밴더 이름, 웹사이트를 구함<br>
밴더 웹 사이트에서 디바이스의 모든 매뉴얼을 읽어봄<br>
기존 접속정보를 구함(USB 장치의 물리적 연결 말고는 안됬음)<br>
root되는 방법(PW 구함)<br>
트러블슈팅 매뉴얼의 예제에서 ID를 볼 수 있었음
3. 접속<br>
펌웨어와 펌웨어 체크 루틴을 구함(바이너리 형태의 펌웨어를 가져오고 싶었음)<br>
펨토셀 관련 정보들을 찾음
4. RCE<br>
특정 포트를 계속 열어두고 있다는 것을 발견 -> 바이너리 분석(IDA 이용)<br>
분석을 통해 unknown MsgType을 bypass할 수 있었음<br>
백도어를 발견, 익스플로잇

## 흠, 그럼 다음은?
펨토셀이 고장나면? 외부에서 이를 체크해야 할 것이다. 그러한 시스템? -> HeMS<br>
설정 파일을 통해 HeMS(HeNB Manage System)의 존재를 알 수 있었음<br>
HeMS 서버에 접근(ID, PW 발견)<br>
XML command list 사용으로 명령을 내릴 수 있었음<br>
계정정보 발견<br>
sftp가 아니라 ftp를 사용하는 취약점 발견<br>
전국에 있는 펨토셀의 데일리 로그 파일을 발견 -> 위치좌표 발견

## Pwn HeMS via Web Service
플래시로 된 웹페이지 -> 액션스크립트 디컴파일<br>
리모트 오브젝트 : JSP의 객체를 사용할 수 있는 오브젝트 -> DeviceManage 오브젝트<br>
-> Shell

## 결론
취약점 발견
